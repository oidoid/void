{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://oidoid.github.io/void/level-file.v0.json",
  "title": "void Level File Schema",
  "type": "object",
  "description": "a JSON representation of a void level file.",
  "$defs": {
    "Border": {
      "description": "border area config.",
      "oneOf": [
        {"type": "integer", "minimum": 0},
        {"$ref": "#/$defs/XY", "unevaluatedProperties": false},
        {
          "type": "object",
          "unevaluatedProperties": false,
          "properties": {
            "n": {
              "type": "integer",
              "description": "north border height.",
              "minimum": 0
            },
            "s": {
              "type": "integer",
              "description": "south border height.",
              "minimum": 0
            },
            "w": {
              "type": "integer",
              "description": "west border width.",
              "minimum": 0
            },
            "e": {
              "type": "integer",
              "description": "east border width.",
              "minimum": 0
            }
          }
        }
      ]
    },
    "Button": {
      "type": "object",
      "description": "button config.",
      "required": ["pressed", "selected"],
      "properties": {
        "pressed": {
          "$ref": "#/$defs/SpritePropsOrTag",
          "description": "pressed config.",
          "unevaluatedProperties": false
        },
        "selected": {
          "$ref": "#/$defs/SpritePropsOrTag",
          "description": "selected config.",
          "unevaluatedProperties": false
        },
        "type": {
          "description": "whether to operate as push to engage or push to toggle.",
          "enum": ["Button", "Toggle"]
        },
        "z": {"$ref": "#/$defs/Layer", "unevaluatedProperties": false}
      }
    },
    "CamConfig": {
      "type": "object",
      "description": "cam config.",
      "allOf": [{"$ref": "#/$defs/XY"}],
      "properties": {
        "minScale": {
          "type": "number",
          "description": "min cam scale.",
          "minimum": 1
        },
        "minWH": {
          "$ref": "#/$defs/WH",
          "description": "min cam dimensions. infinity always uses min scale. defaults to infinity.",
          "unevaluatedProperties": false,
          "properties": {
            "w": {
              "$ref": "#/$defs/UnboundedUInt",
              "unevaluatedProperties": false
            },
            "h": {
              "$ref": "#/$defs/UnboundedUInt",
              "unevaluatedProperties": false
            }
          }
        },
        "zoomOut": {
          "type": "number",
          "description": "cam zoom offset.",
          "minimum": 0
        }
      }
    },
    "CamData": {"type": "object", "description": "cam data config."},
    "CompassDir": {
      "description": "cardinal and ordinal directions and center.",
      "enum": ["Center", "N", "S", "W", "E", "NW", "NE", "SW", "SE"]
    },
    "Cursor": {
      "type": "object",
      "description": "cursor config.",
      "properties": {
        "keyboard": {
          "$ref": "#/$defs/Speed",
          "description": "if greater than zero, follow keyboard movement in pixels per second.",
          "unevaluatedProperties": false
        },
        "pick": {
          "$ref": "tags.json#/$defs/Tag",
          "description": "tag for click state. defaults to point tag."
        }
      }
    },
    "SpritePropsOrTag": {
      "oneOf": [
        {"$ref": "tags.json#/$defs/Tag"},
        {"$ref": "#/$defs/SpriteProps", "unevaluatedProperties": false}
      ]
    },
    "DebugInput": {"type": "object", "description": "debug input config."},
    "DebugLoseContext": {
      "type": "object",
      "description": "debug lose context config."
    },
    "Draw": {"type": "object", "description": "draw config."},
    "Ent": {
      "type": "object",
      "description": "ent config.",
      "properties": {
        "button": {"$ref": "#/$defs/Button", "unevaluatedProperties": false},
        "cam": {"$ref": "#/$defs/CamData", "unevaluatedProperties": false},
        "cursor": {"$ref": "#/$defs/Cursor", "unevaluatedProperties": false},
        "debugInput": {
          "$ref": "#/$defs/DebugInput",
          "unevaluatedProperties": false
        },
        "debugLoseContext": {
          "$ref": "#/$defs/DebugLoseContext",
          "unevaluatedProperties": false
        },
        "draw": {"$ref": "#/$defs/Draw", "unevaluatedProperties": false},
        "fps": {"$ref": "#/$defs/FPS", "unevaluatedProperties": false},
        "hud": {"$ref": "#/$defs/HUD", "unevaluatedProperties": false},
        "id": {"type": "string", "description": "unique lookup identifier."},
        "name": {"type": "string", "description": "debug identifier."},
        "ninePatch": {
          "$ref": "#/$defs/NinePatch",
          "unevaluatedProperties": false
        },
        "override": {
          "$ref": "#/$defs/Override",
          "unevaluatedProperties": false
        },
        "sprite": {
          "oneOf": [
            {"$ref": "tags.json#/$defs/Tag"},
            {"$ref": "#/$defs/Sprite", "unevaluatedProperties": false}
          ]
        },
        "text": {"$ref": "#/$defs/Text", "unevaluatedProperties": false},
        "textWH": {"$ref": "#/$defs/TextWH", "unevaluatedProperties": false},
        "textXY": {"$ref": "#/$defs/TextXY", "unevaluatedProperties": false}
      }
    },
    "EntList": {
      "type": "array",
      "description": "ents config.",
      "items": {
        "$ref": "schema.json#/$defs/Ent",
        "unevaluatedProperties": false
      },
      "uniqueItemProperties": ["id"],
      "$comment": "`uniqueItemProperties` is ajv-keywords only."
    },
    "FPS": {"type": "object", "description": "FPS config."},
    "HUD": {
      "type": "object",
      "description": "HUD config.",
      "required": ["origin"],
      "properties": {
        "fill": {
          "$ref": "#/$defs/XYFlag",
          "description": "whether to adjust the width or height to fill empty space.",
          "unevaluatedProperties": false
        },
        "margin": {
          "$ref": "#/$defs/Border",
          "description": "spacing outside the sprite.",
          "unevaluatedProperties": false
        },
        "modulo": {
          "description": "mod margin. useful for snapping to tile.",
          "oneOf": [
            {"type": "integer", "minimum": 0},
            {"$ref": "#/$defs/UIntXY", "unevaluatedProperties": false}
          ]
        },
        "origin": {
          "$ref": "#/$defs/CompassDir",
          "description": "position relative to.",
          "unevaluatedProperties": false
        }
      }
    },
    "IntXY": {
      "$ref": "#/$defs/XY",
      "properties": {"x": {"type": "integer"}, "y": {"type": "integer"}}
    },
    "Layer": {
      "description": "z.",
      "enum": [
        "Bottom",
        "A",
        "B",
        "C",
        "D",
        "E",
        "F",
        "G",
        "UIA",
        "UIB",
        "UIC",
        "UID",
        "UIE",
        "UIF",
        "UIG",
        "Top"
      ]
    },
    "LevelConfig": {
      "type": "object",
      "description": "level config.",
      "required": ["h", "w"],
      "properties": {
        "h": {
          "type": "integer",
          "description": "level height in pixels.",
          "minimum": 0
        },
        "tiles": {
          "type": "array",
          "description": "tile IDs in row-major order.",
          "items": {"type": "integer", "minimum": 0, "maximum": 65535}
        },
        "w": {
          "type": "integer",
          "description": "level width in pixels.",
          "minimum": 0
        },
        "x": {
          "type": "integer",
          "description": "level x origin."
        },
        "y": {
          "type": "integer",
          "description": "level y origin."
        }
      }
    },
    "NinePatch": {
      "type": "object",
      "description": "nine patch config.",
      "properties": {
        "border": {
          "$ref": "#/$defs/Border",
          "description": "widths and heights of patches.",
          "unevaluatedProperties": false
        },
        "pad": {
          "$ref": "#/$defs/Border",
          "description": "spacing between sprite and patches.",
          "unevaluatedProperties": false
        },
        "patch": {
          "type": "object",
          "description": "sprite config.",
          "unevaluatedProperties": false,
          "properties": {
            "center": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "center patch config.",
              "unevaluatedProperties": false
            },
            "n": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "north patch config.",
              "unevaluatedProperties": false
            },
            "s": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "south patch config.",
              "unevaluatedProperties": false
            },
            "w": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "west patch config.",
              "unevaluatedProperties": false
            },
            "e": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "east patch config.",
              "unevaluatedProperties": false
            },
            "nw": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "northwest patch config.",
              "unevaluatedProperties": false
            },
            "ne": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "northeast patch config.",
              "unevaluatedProperties": false
            },
            "sw": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "southwest patch config.",
              "unevaluatedProperties": false
            },
            "se": {
              "$ref": "#/$defs/SpritePropsOrTag",
              "description": "southeast patch config.",
              "unevaluatedProperties": false
            }
          }
        }
      }
    },
    "Override": {
      "type": "object",
      "description": "override config.",
      "properties": {
        "invalid": {
          "type": "boolean",
          "description": "whether to recompute and render update."
        }
      }
    },
    "RGBA": {
      "type": "string",
      "description": "color (red, green, blue, alpha) in hex.",
      "pattern": "^[A-Fa-f0-9]{8}$",
      "examples": ["01234567"]
    },
    "Speed": {
      "type": "number",
      "description": "velocity in pixels per second."
    },
    "Sprite": {
      "type": "object",
      "description": "sprite config.",
      "allOf": [
        {"$ref": "#/$defs/SpriteProps"},
        {"$ref": "#/$defs/WH"},
        {"$ref": "#/$defs/XY"}
      ],
      "properties": {
        "angle": {
          "type": "number",
          "description": "sprite rotation in degrees."
        },
        "scale": {
          "oneOf": [
            {"type": "integer", "minimum": 1},
            {
              "$ref": "#/$defs/UIntXY",
              "unevaluatedProperties": false,
              "properties": {"x": {"minimum": 1}, "y": {"minimum": 1}}
            }
          ]
        }
      }
    },
    "SpritePool": {"type": "string", "description": "allocator pool."},
    "SpriteProps": {
      "description": "sprite config except box-related.",
      "type": "object",
      "properties": {
        "flip": {"$ref": "#/$defs/XYFlag", "unevaluatedProperties": false},
        "hidden": {
          "type": "boolean",
          "description": "whether sprite is not rendered. defaults to true when tag is unspecified."
        },
        "pool": {"$ref": "#/$defs/SpritePool", "unevaluatedProperties": false},
        "stretch": {
          "type": "boolean",
          "description": "wrap texture (default) or stretch to width and height."
        },
        "tag": {"$ref": "tags.json#/$defs/Tag"},
        "z": {"$ref": "#/$defs/Layer", "unevaluatedProperties": false},
        "zend": {
          "type": "boolean",
          "description": "z-order by top (default) or bottom of box."
        }
      }
    },
    "Text": {"type": "string", "description": "string."},
    "TextWH": {
      "type": "object",
      "description": "text WH config.",
      "properties": {
        "maxW": {
          "type": "integer",
          "description": "maximum width.",
          "minimum": 0,
          "maximum": 4095
        },
        "origin": {
          "$ref": "#/$defs/CompassDir",
          "description": "position relative to.",
          "unevaluatedProperties": false
        },
        "pad": {
          "$ref": "#/$defs/Border",
          "description": "spacing between sprite and patches.",
          "unevaluatedProperties": false
        },
        "scale": {
          "type": "integer",
          "description": "text scalar.",
          "minimum": 1
        },
        "trim": {
          "enum": ["Leading", "Descender"],
          "description": "whether to cut the trailing line leading and descenders."
        }
      }
    },
    "TextXY": {
      "type": "object",
      "description": "text XY config.",
      "properties": {
        "z": {"$ref": "#/$defs/Layer", "unevaluatedProperties": false}
      }
    },
    "UIntXY": {
      "$ref": "#/$defs/IntXY",
      "properties": {"x": {"minimum": 0}, "y": {"minimum": 0}}
    },
    "UnboundedUInt": {
      "oneOf": [{"type": "integer", "minimum": 0}, {"enum": ["Infinity"]}]
    },
    "WH": {
      "type": "object",
      "description": "area. sprite dimensions have an integral range of [0, 4095].",
      "properties": {
        "w": {"type": "integer", "description": "width.", "minimum": 0},
        "h": {"type": "integer", "description": "height.", "minimum": 0}
      }
    },
    "XY": {
      "type": "object",
      "description": "horizontal and vertical dimensions. sprite coordinates have a range of [-131072, 131071.984375] with a granularity of .015625.",
      "properties": {
        "x": {"type": "number", "description": "horizontal dimension."},
        "y": {"type": "number", "description": "vertical dimension."}
      }
    },
    "XYFlag": {
      "description": "horizontal and vertical state.",
      "enum": ["XY", "X", "Y"]
    }
  },
  "unevaluatedProperties": false,
  "required": ["zoo"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "the configuration schema URI.",
      "default": "https://oidoid.github.io/void/level-file.v0.json"
    },
    "background": {
      "$ref": "#/$defs/RGBA",
      "description": "render clear color.",
      "unevaluatedProperties": false
    },
    "cam": {
      "$ref": "#/$defs/CamConfig",
      "description": "cam config.",
      "unevaluatedProperties": false
    },
    "level": {"$ref": "#/$defs/LevelConfig", "unevaluatedProperties": false},
    "zoo": {
      "type": "object",
      "description": "zoo config.",
      "required": ["default"],
      "unevaluatedProperties": false,
      "properties": {
        "default": {"$ref": "#/$defs/EntList", "unevaluatedProperties": false}
      },
      "patternProperties": {
        ".+": {"$ref": "#/$defs/EntList", "unevaluatedProperties": false}
      }
    }
  }
}
